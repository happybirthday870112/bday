<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Yoshi Egg Cake â€“ Unlocked</title>
  <style>
    :root{
      --bg1:#071018; --bg2:#0d1a26;
      --txt:#e7f0ff; --muted:#9fb2c7;
      --green:#41d36a; --green2:#2aa94d;
      --cream:#f3f0e9; --spot:#36c55e;
      --gold:#ffd35a;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", Arial;}
    body{background: radial-gradient(1200px 800px at 20% 10%, #17324a 0%, var(--bg1) 45%, #05070a 100%); color:var(--txt);}
    .wrap{height:100%; display:flex; align-items:center; justify-content:center; padding:16px;}
    .phone{
      width:min(420px, 100%);
      aspect-ratio: 9/16;
      max-height: calc(100vh - 32px);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 26px;
      overflow:hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
      position:relative;
      display:flex;
      flex-direction:column;
    }
    .top{
      padding:16px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      backdrop-filter: blur(8px);
    }
    h1{margin:0; font-size:18px; font-weight:1000;}
    .hint{margin:6px 0 0; font-size:12px; color:var(--muted); line-height:1.55;}
    .main{flex:1; padding:14px; position:relative;}
    .card{
      height:100%;
      background: rgba(0,0,0,.20);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      padding:14px;
      position:relative;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .btn{
      appearance:none; border:0; cursor:pointer;
      padding:10px 12px; border-radius: 12px;
      background: rgba(255,255,255,.10);
      color:var(--txt);
      border:1px solid rgba(255,255,255,.14);
      font-weight:800;
      text-decoration:none;
      display:inline-flex; align-items:center; justify-content:center;
      gap:8px;
    }
    .btn.primary{
      background: linear-gradient(180deg, rgba(65,211,106,.95), rgba(42,169,77,.95));
      border-color: rgba(65,211,106,.65);
      color:#04200d;
    }
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
    .pill{
      padding:6px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      display:inline-flex; gap:8px; align-items:center;
      color:var(--txt);
      font-weight:800;
      font-size:12px;
    }

    /* egg cake */
    .stage{flex:1; display:flex; align-items:center; justify-content:center; position:relative;}
    .cake{
      width:240px; height:320px;
      border-radius: 999px;
      background: radial-gradient(circle at 40% 20%, rgba(255,255,255,.92), var(--cream) 56%, #d8d2c7 100%);
      border: 2px solid rgba(255,255,255,.30);
      box-shadow: 0 22px 60px rgba(0,0,0,.30);
      position:relative;
      overflow:hidden;
      user-select:none;
      cursor:pointer;
    }
    .spot{position:absolute; border-radius: 999px; background: rgba(54,197,94,.92);}
    .spot.s1{width:64px;height:84px; left:38px; top:62px;}
    .spot.s2{width:44px;height:52px; right:50px; top:110px;}
    .spot.s3{width:84px;height:64px; left:78px; top:182px;}
    .frost{
      position:absolute; left:0; right:0; bottom:-34px; height:90px;
      background: linear-gradient(180deg, rgba(65,211,106,.0), rgba(65,211,106,.32));
      filter: blur(0.2px);
    }
    .lock{
      width:240px; height:320px; border-radius: 999px;
      border: 2px dashed rgba(255,255,255,.22);
      display:flex; align-items:center; justify-content:center;
      color:rgba(255,255,255,.65);
      background: rgba(255,255,255,.05);
      text-align:center;
      padding:18px;
    }

    /* message popup */
    .overlay{
      position:absolute; inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center; justify-content:center;
      padding:18px;
    }
    .overlay.show{display:flex}
    .modal{
      width:100%;
      background: rgba(10,14,18,.92);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 18px;
      padding:14px;
      text-align:center;
    }
    .jp{
      font-size:20px;
      font-weight:1000;
      letter-spacing:.3px;
      margin:6px 0 8px;
      color: var(--gold);
    }
    .small{font-size:12px; color:var(--muted); margin:0 0 12px; line-height:1.6;}

    /* confetti */
    .confetti{
      position:absolute; inset:0; overflow:hidden; pointer-events:none;
    }
    .c{
      position:absolute; top:-20px;
      width:10px; height:14px;
      border-radius: 4px;
      opacity:.95;
      animation: fall linear forwards;
    }
    @keyframes fall{
      to{ transform: translateY(120vh) rotate(520deg); opacity:1; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="phone">
      <div class="top">
        <h1>è€€è¥¿è›‹ç”Ÿæ—¥è›‹ç³•ï¼ˆè§£é–å€ï¼‰</h1>
        <p class="hint" id="desc">å®Œæˆå…­å€‹å°éŠæˆ²å¾Œï¼Œé»ä¸€ä¸‹è›‹ç³•å°±æœƒå½ˆå‡ºé©šå–œç¥ç¦ã€‚</p>
      </div>

      <div class="main">
        <div class="card">
          <div class="row">
            <span class="pill" id="prog">é€²åº¦ï¼š0/6</span>
            <a class="btn" href="play.html">å›åˆ°é¸å–®</a>
            <button class="btn" id="reset">é‡ç½®é€²åº¦ï¼ˆæ¸¬è©¦ï¼‰</button>
          </div>

          <div class="stage">
            <div id="stageInner"></div>
            <div class="confetti" id="confetti"></div>
          </div>

          <div class="row">
            <a class="btn primary" id="goFinal" href="#" style="flex:1">é»æˆ‘åˆ‡è›‹ç³• ğŸ‚</a>
          </div>
        </div>

        <div class="overlay" id="ov">
          <div class="modal">
            <div class="jp" id="jp">ã‚¢ã‚¿ãƒ³ã€œãŠèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã†ï¼</div>
            <p class="small">ï¼ˆé˜¿ç™±ï½ç”Ÿæ—¥å¿«æ¨‚ï¼‰</p>
            <button class="btn primary" id="close">æ”¶ä¸‹ç¥ç¦</button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  const $ = (s, el=document) => el.querySelector(s);
  const KEY_PREFIX = "yoshiGift_g";
  const getDone = (i) => localStorage.getItem(KEY_PREFIX + i) === "1";
  const clearAll = () => { for(let i=1;i<=6;i++) localStorage.removeItem(KEY_PREFIX+i); };

  const prog = $("#prog");
  const stageInner = $("#stageInner");
  const btnReset = $("#reset");
  const btnFinal = $("#goFinal");
  const ov = $("#ov");
  const close = $("#close");
  const confetti = $("#confetti");

  function countDone(){
    let n=0; for(let i=1;i<=6;i++) if(getDone(i)) n++;
    return n;
  }

  function render(){
    const n = countDone();
    prog.textContent = `é€²åº¦ï¼š${n}/6`;
    confetti.innerHTML = "";
    if(n<6){
      stageInner.innerHTML = `
        <div class="lock">
          <div>
            <div style="font-weight:1000; font-size:16px; margin-bottom:6px;">å°šæœªè§£é–</div>
            <div style="font-size:12px; opacity:.85; line-height:1.6;">
              é‚„å·® <b>${6-n}</b> é—œã€‚<br/>
              å»æŠŠå…­å¼µå¡ç‰‡éƒ½ç ´é—œå§ã€‚
            </div>
          </div>
        </div>`;
      btnFinal.onclick = (e)=>{ e.preventDefault(); location.href="play.html"; };
      btnFinal.textContent = "å›å»ç ´é—œ â–¶ï¸";
    }else{
      stageInner.innerHTML = `
        <div class="cake" id="cake" role="button" aria-label="è›‹ç³•">
          <div class="spot s1"></div>
          <div class="spot s2"></div>
          <div class="spot s3"></div>
          <div class="frost"></div>
        </div>`;
      btnFinal.textContent = "é»æˆ‘åˆ‡è›‹ç³• ğŸ‚";
      btnFinal.onclick = (e)=>{ e.preventDefault(); pop(); };
      $("#cake").addEventListener("click", pop);
    }
  }

  function pop(){
    launchConfetti();
    ov.classList.add("show");
  }

  function launchConfetti(){
    confetti.innerHTML="";
    const N = 70;
    for(let i=0;i<N;i++){
      const d=document.createElement("div");
      d.className="c";
      d.style.left = Math.random()*100 + "%";
      d.style.animationDuration = (2.8 + Math.random()*1.8) + "s";
      d.style.animationDelay = (Math.random()*0.15) + "s";
      // keep simple: use a few bright colors
      const colors = ["#41d36a","#ffd35a","#7dd3ff","#ff7aa2","#ffffff"];
      d.style.background = colors[Math.floor(Math.random()*colors.length)];
      d.style.transform = `translateY(0) rotate(${Math.random()*180}deg)`;
      confetti.appendChild(d);
    }
  }

  close.addEventListener("click", ()=> ov.classList.remove("show"));
  btnReset.addEventListener("click", ()=>{ clearAll(); render(); });
  render();
})();
</script>
</body>
</html>
